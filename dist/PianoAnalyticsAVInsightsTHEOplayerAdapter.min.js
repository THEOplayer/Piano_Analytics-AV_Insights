!function(e){var a={};function t(n){if(a[n])return a[n].exports;var i=a[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var i in e)t.d(n,i,function(a){return e[a]}.bind(null,i));return n},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="",t(t.s=0)}([function(e,a,t){"use strict";function n(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,a,t){return a&&n(e.prototype,a),t&&n(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,a,t){r(e,a),a.set(e,t)}function r(e,a){if(a.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o(e,a){return function(e,a){if(a.get)return a.get.call(e);return a.value}(e,c(e,a,"get"))}function s(e,a,t){return function(e,a,t){if(a.set)a.set.call(e,t);else{if(!a.writable)throw new TypeError("attempted to set read only private field");a.value=t}}(e,c(e,a,"set"),t),t}function c(e,a,t){if(!a.has(e))throw new TypeError("attempted to "+t+" private field on non-instance");return a.get(e)}t.r(a),t.d(a,"AVInsights",(function(){return K}));var p=new WeakMap,d=new WeakMap,u=new WeakMap,v=new WeakMap,y=new WeakMap,w=new WeakMap,f=new WeakMap,h=new WeakMap,b=new WeakMap,g=new WeakMap,k=new WeakMap,m=new WeakMap,M=new WeakMap,_=new WeakMap,E=new WeakSet,W=new WeakMap,L=new WeakMap,T=new WeakMap,P=new WeakMap,S=new WeakMap,O=new WeakMap,I=new WeakMap,j=new WeakMap,A=new WeakMap,x=new WeakMap,R=new WeakMap,V=new WeakMap,H=new WeakMap,C=new WeakMap,z=new WeakMap,D=new WeakMap,K=i((function e(a,t){var n,i,c=this;!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,e),r(n=this,i=E),i.add(n),l(this,p,{writable:!0,value:void 0}),l(this,d,{writable:!0,value:void 0}),l(this,u,{writable:!0,value:void 0}),l(this,v,{writable:!0,value:void 0}),l(this,y,{writable:!0,value:void 0}),l(this,w,{writable:!0,value:void 0}),l(this,f,{writable:!0,value:void 0}),l(this,h,{writable:!0,value:void 0}),l(this,b,{writable:!0,value:void 0}),l(this,g,{writable:!0,value:void 0}),l(this,k,{writable:!0,value:void 0}),l(this,m,{writable:!0,value:void 0}),l(this,M,{writable:!0,value:void 0}),l(this,_,{writable:!0,value:void 0}),l(this,W,{writable:!0,value:function(){c.player.removeEventListener("play",o(c,W)),o(c,w)&&console.log("media.play("+o(c,L).call(c)+");"),o(c,u).play(o(c,L).call(c))}}),l(this,L,{writable:!0,value:function(e){return e?Math.floor(1e3*e):Math.floor(1e3*c.player.currentTime)}}),l(this,T,{writable:!0,value:function(e){o(c,w)&&console.log("media.bufferStart("+o(c,L).call(c)+");"),o(c,u).bufferStart(o(c,L).call(c))}}),l(this,P,{writable:!0,value:function(e){s(c,f,!0),player.removeEventListener("playing",o(c,P)),o(c,w)&&console.log("media.playbackStart("+o(c,L).call(c,e.currentTime)+");"),o(c,u).playbackStart(e.currentTime)}}),l(this,S,{writable:!0,value:function(e){o(c,h)||(o(c,_)?(o(c,w)&&console.log("adMedia.playbackPaused("+o(c,L).call(c)+");"),o(c,v).playbackPaused(o(c,L).call(c))):(o(c,w)&&console.log("media.playbackPaused("+o(c,L).call(c)+");"),o(c,u).playbackPaused(o(c,L).call(c))))}}),l(this,O,{writable:!0,value:function(e){o(c,M)||c.player.ads.playing||s(c,m,c.player.currentTime)}}),l(this,I,{writable:!0,value:function(e){c.player.ads.playing||s(c,k,1e3*e.duration)}}),l(this,j,{writable:!0,value:function(e){s(c,M,!0)}}),l(this,A,{writable:!0,value:function(e){if(s(c,M,!1),o(c,f)){var a=c.player.currentTime;if(a==o(c,m))return;o(c,w)&&console.log("media.seek("+o(c,L).call(c,o(c,m))+","+o(c,L).call(c,a)+");"),o(c,u).seek(o(c,L).call(c,o(c,m)),o(c,L).call(c,a))}}}),l(this,x,{writable:!0,value:function(e){!o(c,f)||o(c,M)||c.player.ads.playing||(o(c,w)&&console.log("media.playbackResumed("+o(c,L).call(c)+");"),o(c,u).playbackResumed(o(c,L).call(c)))}}),l(this,R,{writable:!0,value:function(e){o(c,f)&&(s(c,h,!0),o(c,w)&&console.log("media.playbackStopped("+o(c,L).call(c)+");"),o(c,u).playbackStopped(o(c,L).call(c)))}}),l(this,V,{writable:!0,value:function(){s(c,k,o(c,y).av_content_duration||player.duration);var e={av_content_id:o(c,y).av_content_id,av_content:o(c,y).av_content,av_content_type:o(c,y).av_content_type,av_content_duration:o(c,k),av_content_genre:o(c,y).av_content_genre,av_player:"THEOplayer Web SDK",av_player_version:window.THEOplayer&&window.THEOplayer.version};o(c,w)&&console.log("calling media.setProps with",e),o(c,u).setProps(e)}}),l(this,H,{writable:!0,value:function(e){s(c,g,e.ad.integration&&"google-ima"==e.ad.integration),s(c,v,new(o(c,d).avInsights.Media)(5,5));var a=e.ad,t=o(c,m)+5>o(c,k)/1e3,n=o(c,m)<.5?"preroll":t?"postroll":"midroll",i={av_content_id:a.creativeId,av_content:n+"-"+a.creativeId,av_content_type:"video",av_ad_type:n,av_content_linked:o(c,u).getProps().av_content_id,av_content_duration:o(c,L).call(c,a.duration)};o(c,w)&&console.log("calling adMedia.setProps with",i),o(c,v).setProps(i)}}),l(this,C,{writable:!0,value:function(e){c.player.ads.playing&&!o(c,_)&&(o(c,g)&&(o(c,u).playbackPaused(o(c,L).call(c,o(c,m))),o(c,w)&&console.log("media.playbackPaused("+o(c,L).call(c,o(c,m))+")")),o(c,w)&&(console.log("adMedia.play("+o(c,L).call(c)+")"),console.log("adMedia.playbackStart("+o(c,L).call(c)+")")),o(c,v).play(o(c,L).call(c)),o(c,v).playbackStart(o(c,L).call(c))),c.player.ads.playing&&s(c,_,!0)}}),l(this,z,{writable:!0,value:function(e){o(c,_)&&(o(c,w)&&console.log("adMedia.playbackResumed("+o(c,L).call(c)+");"),o(c,v).playbackResumed(o(c,L).call(c)))}}),l(this,D,{writable:!0,value:function(e){s(c,_,!1),o(c,w)&&console.log("adMedia.playbackStopped("+o(c,L).call(c,e.ad.duration)+")"),o(c,v).playbackStopped(o(c,L).call(c,e.ad.duration))}}),this.player=a,this.configuration=t,function(e,a,t){if(!a.has(e))throw new TypeError("attempted to get private field on non-instance");return t}(this,E,q).call(this)}));function q(){var e,a,t,n=this;s(this,p,null===(e=this.configuration)||void 0===e?void 0:e.accountId),t=o(this,p)?new ATInternet.Tracker.Tag({site:o(this,p)}):new ATInternet.Tracker.Tag,s(this,u,new t.avInsights.Media(5,5)),s(this,d,t),s(this,f,!1),s(this,h,!1),s(this,b,[]),s(this,v,{}),s(this,g,!1),s(this,y,!1),s(this,w,null===(a=this.configuration)||void 0===a?void 0:a.debug),s(this,k,-1),s(this,m,-1),s(this,M,!1),s(this,_,!1),o(this,w)&&console.log("Piano Analytics version:",o(this,d).version),player.addEventListener("sourcechange",(function(e){o(n,w)&&console.log("sourcechange",e.source),e.source.pianoAnalyticsAVInsights&&(s(n,y,e.source.pianoAnalyticsAVInsights.metadata),s(n,f,!1),s(n,h,!1),o(n,V).call(n),s(n,b,[]),s(n,v,{}),player.removeEventListener("play",o(n,W)),player.addEventListener("play",o(n,W)),player.removeEventListener("waiting",o(n,T)),player.addEventListener("waiting",o(n,T)),player.removeEventListener("playing",o(n,P)),player.addEventListener("playing",o(n,P)),player.removeEventListener("pause",o(n,S)),player.addEventListener("pause",o(n,S)),player.removeEventListener("timeupdate",o(n,O)),player.addEventListener("timeupdate",o(n,O)),player.removeEventListener("durationchange",o(n,I)),player.addEventListener("durationchange",o(n,I)),player.removeEventListener("seeking",o(n,j)),player.addEventListener("seeking",o(n,j)),player.removeEventListener("seeked",o(n,A)),player.addEventListener("seeked",o(n,A)),player.removeEventListener("playing",o(n,x)),player.addEventListener("playing",o(n,x)),player.removeEventListener("ended",o(n,R)),player.addEventListener("ended",o(n,R)),player.ads.removeEventListener("adbegin",o(n,H)),player.ads.addEventListener("adbegin",o(n,H)),player.removeEventListener("playing",o(n,C)),player.addEventListener("playing",o(n,C)),player.ads.removeEventListener("adend",o(n,D)),player.ads.addEventListener("adend",o(n,D)),player.removeEventListener("play",o(n,z)),player.addEventListener("play",o(n,z)))}))}window.AVInsights=K}]);